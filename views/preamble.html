{{block "preamble" .}}
<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="/static/htmx.min.js"></script>
  <link href="/static/output.css" rel="stylesheet" />
  <script src="/static/head-support.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <title></title>
</head>

<body class="bg-shark-950" hx-ext="head-support">
  {{template "navBar" .User}}
  <div class="flex justify-center p-4 text-shark-200">
    <section class="sm:w-full xl:w-3/4">
      <strong class="text-center font-semibold text-2xl">{{.Offer.Title}}</strong>
      <div class="flex flex-row py-4 gap-2">
        <div class="w-3/4 flex flex-col gap-2">
          <div class="flex flex-row text-shark-100">
            <div class="w-1/2">
              <span class="hover:underline hover:underline-offset-1 hover:cursor-pointer"
                hx-get="/companies/{{.Offer.CompanyID}}" hx-boost="true" hx-push-url="true" hx-target="body">
                {{.Offer.CompanyName}}
              </span>
            </div>
            <p class="w-1/2">
              {{.Offer.MinWage}} - {{.Offer.MaxWage}}
              <span class="font-semibold text-xl">$</span>
            </p>
          </div>
          <span class="font-semibold block">Sobre el puesto</span>
          <pre class="whitespace-pre-wrap text-shark-200 text-sm">{{.Offer.About}}</pre>
          <span class="font-semibold block">Requisitos</span>
          <pre class="whitespace-pre-wrap text-shark-200 text-sm">{{.Offer.Requirements}}</pre>
          <span class="font-semibold block">Beneficios</span>
          <pre class="whitespace-pre-wrap text-shark-200 text-sm">{{.Offer.Benefits}}</pre>
        </div>
        <div class="w-1/4">
          <div class="flex flex-col gap-2 justify-around bg-shark-900 rounded p-4">
            <p class="text-center text-xl">Prueba</p>
            <p class="flex items-center text-shark-200 gap-2">
              <img class="inline" src="/public/clock.svg" width="20" height="20" alt="clock icon" />
              {{.Quiz.Duration}} minutos
            </p>
            <div class="flex flex-wrap gap-2 overflow-x-auto max-w-full">
              {{range .Languages}}
              <span class="rounded border border-shark-200 text-shark-200 px-2">{{.DisplayName}}</span>
              {{end}}
            </div>

            {{template "participationInfo" .}}
          </div>
        </div>
      </div>
    </section>
  </div>
</body>

</html>
{{end}} {{block "participationInfo" .}} 
{{if .Results}}
<p class="text-shark-200">Entregado {{.Participation.RelativeTime}}</p>

<div class="p-8">
    <div class="flex justify-between">
      <span class="text-shark-200 text-xl font-semibold">Problema</span>
      <span class="text-shark-200 text-xl font-semibold">Puntaje</span>
    </div>
  <div class="flex flex-col gap-2">
    {{$applicant := .User}}
    {{range .Results}}
    <section class="flex gap-2">
      <div class="flex-auto flex justify-between">
        <span class="text-shark-200">{{.Problem.Title}}</span>
        {{if eq .Score.AcceptedTestCases 0}}
        <span class="text-red-500">
        {{else}}
          {{if eq .Score.AcceptedTestCases .Score.TotalTestCases}}
        <span class="text-green-600">
          {{else}}
        <span class="text-yellow-600">
          {{end}}
        {{end}}
          {{.Score.AcceptedTestCases}}/{{.Score.TotalTestCases}}</span>
      </div>
    </section>
    <div 
      class="bg-gray-900 hover:bg-gray-800 px-4 py-2 cursor-pointer"
      hx-get="/source/{{.Problem.ID}}/{{$applicant.ID}}"
      hx-swap="outerHTML"
    >
      <img src="/public/eye.svg" alt="home icon" width="15" height="15" />
    </div>
    {{end}}
  </div>
</div>

{{else}} {{if eq .User.Role "verified"}}
<div class="flex justify-center">
  <button
    class="border rounded border-blue-400 hover:border-blue-600 hover:text-blue-600 text-blue-400 font-bold w-32 text-center py-2 px-4"
    hx-post="/participate" hx-vals="js:{quizID: '{{.Quiz.ID}}'}"
    hx-confirm="EstÃ¡s seguro de que quieres tomar esta prueba?">
    Participar
  </button>
</div>
{{end}} {{end}} 
{{end}}
